
# AHK Converter User Guide

This comprehensive guide helps you get the most out of the AHK Converter VS Code extension.

## Table of Contents

- [Getting Started](#getting-started)
- [Basic Usage](#basic-usage)
- [Advanced Features](#advanced-features)
- [Batch Processing](#batch-processing)
- [Enhanced Diff View](#enhanced-diff-view)
- [Configuration](#configuration)
- [Best Practices](#best-practices)
- [Examples](#examples)

## Getting Started

### Prerequisites

1. **VS Code 1.84.0 or later**
2. **AutoHotkey v2 installed** from [autohotkey.com](https://www.autohotkey.com/)
3. **AHK v1 files** to convert

### Quick Start

1. **Install the extension** from VS Code Marketplace
2. **Open an AHK v1 file** in VS Code
3. **Press Ctrl+Shift+A** to convert to new tab
4. **Review the converted code** and save if satisfied

## Basic Usage

### Single File Conversion

#### Method 1: Command Palette

1. Open your AHK v1 file
2. Press `Ctrl+Shift+P` (or `Cmd+Shift+P` on Mac)
3. Type "AHK" to see available commands
4. Select "AHK: Convert v1 to v2 - open in new tab"

#### Method 2: Context Menu

1. Right-click on your AHK file in the editor
2. Select "AHK: Convert v1 to v2 - open in new tab"

#### Method 3: Keyboard Shortcut

1. Open your AHK file
2. Press `Ctrl+Shift+A` (or `Cmd+Shift+A` on Mac)

### Conversion Options

| Option | Description | When to Use |
|---------|-------------|--------------|
| **Open in new tab** | Opens converted code in new tab | For review before saving |
| **Replace current file** | Replaces original with converted code | When confident in conversion |
| **Show enhanced diff** | Shows side-by-side comparison | For careful review of changes |

## Advanced Features

### Enhanced Error Handling

When errors occur, you'll see detailed notifications:

```
‚ùå Validation Error: The AHK file could not be validated for conversion.
[Show Details] [Learn More] [Check file syntax] [Ensure file contains AHK v1 code]
```

**Actions Available:**
- **Show Details**: Opens output channel with technical information
- **Learn More**: Opens relevant documentation in browser
- **Recovery Actions**: Specific steps to resolve the issue

### Conversion Statistics

After each conversion, you'll see:

```
‚úÖ Conversion completed: 150 lines processed, 2 warnings, 0 errors (250ms)
```

**Statistics Include:**
- Lines processed
- Number of warnings
- Number of errors
- Conversion time in milliseconds

### Input Validation

The extension validates your AHK v1 files before conversion:

**Common Validation Warnings:**
- `Line 5: Old MsgBox syntax detected - should be converted to function call`
- `Line 12: Legacy If statement detected - may need conversion`
- `File may not contain AHK v1 syntax patterns`

**Validation Levels:**
- **Strict**: Detailed checks with comprehensive validation
- **Normal**: Standard validation (recommended)
- **Lenient**: Minimal checks for faster processing

## Batch Processing

### Starting Batch Conversion

#### Method 1: Command Palette

1. Press `Ctrl+Shift+P`
2. Type "AHK batch"
3. Select "AHK: Convert multiple files (batch)"

#### Method 2: Explorer Context Menu

1. Select multiple .ahk files in VS Code explorer
2. Right-click on selected files
3. Choose "AHK: Convert multiple files (batch)"

### Batch Conversion Workflow

1. **File Selection**: Choose files to convert
2. **Progress Tracking**: Monitor conversion progress
3. **Results Review**: See conversion summary
4. **Save Options**: Choose how to save results

### Batch Progress Tracking

```
üîÑ Converting multiple AHK files...
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 75% 
Converting script3.ahk (3/4)
```

**Progress Features:**
- Visual progress bar
- Current file being processed
- Cancellation support
- Real-time status updates

### Batch Results Summary

```
‚úÖ Batch conversion completed: 3 successful, 1 failed
Processed 4 files total
[View Results] [Save Successful] [Open Folder]
```

**Results Include:**
- Success/failure count
- Individual file results
- Error details for failed conversions
- Conversion statistics for each file

### Batch Output Options

#### Suffix Naming (Default)
```
original.ahk ‚Üí original_v2.ahk
script1.ahk ‚Üí script1_v2.ahk
```

#### Directory Naming
```
input/
  script1.ahk
  script2.ahk
output/
  v2/
    script1.ahk
    script2.ahk
```

#### Prompt Naming
- Prompts for filename for each converted file
- Full control over output naming
- Best for custom workflows

## Enhanced Diff View

### Opening Enhanced Diff

1. Open your AHK v1 file
2. Press `Ctrl+Shift+D` (or `Cmd+Shift+D`)
3. Or select "AHK: Convert v1 to v2 - show enhanced diff"

### Diff View Features

#### Side-by-Side Comparison
```
Original (v1)                | Converted (v2)
------------------------------|------------------------------
MsgBox, Hello World!          | MsgBox("Hello World!")
IfWinExist, Notepad          | if WinExist("Notepad")
Return                       | return
```

#### Color-Coded Changes
- üî¥ **Red**: Removed content
- üü¢ **Green**: Added content
- üü° **Yellow**: Modified content
- üîµ **Blue**: Informational changes

#### Diff Options
```json
{
  "showLineNumbers": true,
  "highlightChanges": true,
  "ignoreWhitespace": false,
  "contextLines": 3
}
```

### Accepting Changes

#### Accept All Changes
1. In diff view, click "Accept All" in notification
2. Original file is replaced with converted version
3. File is automatically saved

#### Accept Selected Changes
1. Review changes in diff view
2. Manually copy desired changes
3. Paste into original file
4. Save manually

## Configuration

### Accessing Settings

1. **VS Code Settings**: File ‚Üí Preferences ‚Üí Settings
2. **Search for "AHK Converter"**
3. **Adjust settings** as needed

### Recommended Configuration

#### For Beginners
```json
{
  "ahkConverter.validationLevel": "normal",
  "ahkConverter.enableEnhancedDiff": true,
  "ahkConverter.showConversionStats": true,
  "ahkConverter.enableNotifications": true,
  "ahkConverter.defaultOutputNaming": "suffix"
}
```

#### For Power Users
```json
{
  "ahkConverter.validationLevel": "strict",
  "ahkConverter.enableEnhancedDiff": true,
  "ahkConverter.showConversionStats": false,
  "ahkConverter.enableNotifications": false,
  "ahkConverter.autoSaveAfterConversion": true,
  "ahkConverter.defaultOutputNaming": "directory"
}
```

#### For Large Projects
```json
{
  "ahkConverter.validationLevel": "lenient",
  "ahkConverter.enableEnhancedDiff": false,
  "ahkConverter.showConversionStats": false,
  "ahkConverter.batchOutputDirectory": "C:\\AHK\\Converted",
  "ahkConverter.defaultOutputNaming": "directory"
}
```

## Best Practices

### Before Conversion

1. **Backup your files**: Always keep original copies
2. **Test with simple files**: Verify setup with basic AHK code
3. **Check file encoding**: Use UTF-8 for best compatibility
4. **Review validation warnings**: Address issues before conversion

### During Conversion

1. **Use diff view for important files**: Review all changes carefully
2. **Monitor conversion statistics**: Watch for unusual error counts
3. **Check output channel**: Review detailed conversion logs
4. **Save frequently**: Don't lose conversion progress

### After Conversion

1. **Test converted code**: Ensure functionality is preserved
2. **Compare behavior**: Verify v2 code works like v1 original
3. **Update documentation**: Document any behavior changes
4. **Version control**: Commit both original and converted versions

### Batch Processing Best Practices

1. **Organize files**: Group related files together
2. **Use consistent naming**: Maintain clear file organization
3. **Process in batches**: Convert 10-20 files at most at once
4. **Review results**: Check each batch conversion summary
5. **Handle failures**: Address failed conversions individually

## Examples

### Example 1: Simple Script Conversion

**Original (v1):**
```autohotkey
#NoEnv
SendMode Input

MsgBox, Hello World!
IfWinExist, Notepad
{
    WinActivate
    Send, This is a test
}
Return
```

**Converted (v2):**
```autohotkey
#Requires AutoHotkey v2.0
SendMode "Input"

MsgBox("Hello World!")
if WinExist("Notepad")
{
    WinActivate()
    Send("This is a test")
}
```

